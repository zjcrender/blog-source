name: deploy
run-name: blog deploy ðŸš€

on: 
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on:
      steps:
        - name: Checkout
          uses: actions/checkout@v3
          with:
            fetch-depth: 1
            submodules: recursive

        - name: Setup Hugo
          uses: peaceiris/actions-hugo@v2
          with:
            hugo-version: '0.104.3'

        - name: Build Web
          run: hugo --minify

        - name: Deploy Web
          uses: peaceiris/actions-gh-pages@v3
          with:
            PERSONAL_TOKEN: ${{ secrets.ACCESS_TOKEN }}
            EXTERNAL_REPOSITORY: zjcrender/zjcrender.github.io
            PUBLISH_BRANCH: main
            PUBLISH_DIR: ./public
            commit_message: ${{ github.event.head_commit.message }}
